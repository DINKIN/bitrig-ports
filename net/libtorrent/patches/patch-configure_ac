--- configure.ac.orig	Wed May 14 16:18:48 2014
+++ configure.ac	Sun Nov  2 01:45:17 2014
@@ -29,17 +29,18 @@ AC_C_BIGENDIAN(
     AC_MSG_ERROR([Could not determine endianness])
 )
 
-TORRENT_CHECK_CXXFLAGS
-TORRENT_ENABLE_ALIGNED
-TORRENT_ENABLE_INTERRUPT_SOCKET
-TORRENT_ENABLE_DEBUG
-TORRENT_ENABLE_EXTRA_DEBUG
-TORRENT_ENABLE_WERROR
-TORRENT_ENABLE_TR1
-TORRENT_ENABLE_CXX11
+RAK_ENABLE_DEBUG
+RAK_ENABLE_EXTRA_DEBUG
+RAK_ENABLE_WERROR
 
+RAK_CHECK_CXX11
+RAK_CHECK_TR1_LIB
+
 AC_SYS_LARGEFILE
 
+TORRENT_ENABLE_ALIGNED
+TORRENT_ENABLE_INTERRUPT_SOCKET
+
 TORRENT_ENABLE_ARCH
 TORRENT_WITH_SYSROOT
 
@@ -52,13 +53,15 @@ TORRENT_WITH_ADDRESS_SPACE
 
 TORRENT_WITHOUT_STATVFS
 TORRENT_WITHOUT_STATFS
+TORRENT_WITH_INOTIFY
 
 CC_ATTRIBUTE_VISIBILITY
 
-AX_PTHREAD([], AC_MSG_ERROR([requires pthread]))
+AX_PTHREAD
+AX_CHECK_ZLIB
 
-CFLAGS="$CFLAGS $PTHREAD_CFLAGS"
-CXXFLAGS="$CXXFLAGS $PTHREAD_CFLAGS"
+CFLAGS="$PTHREAD_CFLAGS $CFLAGS"
+CXXFLAGS="$PTHREAD_CFLAGS $CXXFLAGS"
 LIBS="$PTHREAD_LIBS $LIBS"
 
 AC_ARG_ENABLE(openssl,
@@ -101,7 +104,6 @@ TORRENT_CHECK_POPCOUNT()
 TORRENT_CHECK_EXECINFO()
 TORRENT_CHECK_PTHREAD_SETNAME_NP()
 TORRENT_MINCORE()
-TORRENT_OTFD()
 
 TORRENT_DISABLE_IPV6
 TORRENT_DISABLE_INSTRUMENTATION
