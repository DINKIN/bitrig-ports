$OpenBSD: patch-giscanner_dumper_py,v 1.6 2013/03/28 19:32:11 jasper Exp $
--- giscanner/dumper.py.orig	Fri Apr 12 11:44:49 2013
+++ giscanner/dumper.py	Fri Apr 12 11:44:57 2013
@@ -82,14 +82,14 @@
         self._get_type_functions = get_type_functions
         self._error_quark_functions = error_quark_functions
 
-        self._compiler_cmd = os.environ.get('CC', 'gcc')
+        self._compiler_cmd = os.environ.get('CC', '${CC}')
         self._linker_cmd = os.environ.get('CC', self._compiler_cmd)
         self._pkgconfig_cmd = os.environ.get('PKG_CONFIG', 'pkg-config')
         self._pkgconfig_msvc_flags = ''
         # Enable the --msvc-syntax pkg-config flag when
         # the Microsoft compiler is used
         # (This is the other way to check whether Visual C++ is used subsequently)
-        if 'cl' in self._compiler_cmd:
+        if not 'clang' in self._compiler_cmd and 'cl' in self._compiler_cmd:
             self._pkgconfig_msvc_flags = '--msvc-syntax'
         self._uninst_srcdir = os.environ.get(
             'UNINSTALLED_INTROSPECTION_SRCDIR')
@@ -204,7 +204,7 @@
         args = self._compiler_cmd.split()
         # Do not add -Wall when using init code as we do not include any
         # header of the library being introspected
-        if self._compiler_cmd == 'gcc' and not self._options.init_sections:
+        if self._compiler_cmd == 'cc' and not self._options.init_sections:
             args.append('-Wall')
         # The Microsoft compiler uses different option flags for
         # silencing warnings on deprecated function usage
