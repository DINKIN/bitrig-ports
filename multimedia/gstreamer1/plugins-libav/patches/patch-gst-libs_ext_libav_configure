$OpenBSD: patch-gst-libs_ext_libav_configure,v 1.3 2013/03/22 17:22:50 ajacoutot Exp $
--- gst-libs/ext/libav/configure.orig	Fri Mar 22 10:34:41 2013
+++ gst-libs/ext/libav/configure	Tue Apr 23 00:18:13 2013
@@ -2435,7 +2435,7 @@ case $target_os in
         oss_indev_extralibs="-lossaudio"
         oss_outdev_extralibs="-lossaudio"
         ;;
-    openbsd)
+    openbsd|bitrig)
         enable malloc_aligned
         # On OpenBSD 4.5. the compiler does not use PIC unless
         # explicitly using -fPIC. Libav builds fine without PIC,
@@ -2623,7 +2623,7 @@ die_license_disabled version3 libvo_amrwbenc
 
 enabled version3 && { enabled gpl && enable gplv3 || enable lgplv3; }
 
-disabled optimizations || check_cflags -fomit-frame-pointer
+enabled x86_32 && check_cflags -fomit-frame-pointer
 
 enable_pic() {
     enable pic
@@ -3066,7 +3066,6 @@ enabled extra_warnings && check_cflags -Winline
 # add some linker flags
 check_ldflags -Wl,--warn-common
 check_ldflags -Wl,-rpath-link=libpostproc:libswscale:libavfilter:libavdevice:libavformat:libavcodec:libavutil
-test_ldflags -Wl,-Bsymbolic && append SHFLAGS -Wl,-Bsymbolic
 
 echo "X{};" > $TMPV
 if test_ldflags -Wl,--version-script,$TMPV; then
@@ -3085,10 +3084,6 @@ if [ -n "$optflags" ]; then
     add_cflags $optflags
 elif enabled small; then
     add_cflags $size_cflags
-elif enabled optimizations; then
-    add_cflags $speed_cflags
-else
-    add_cflags $noopt_cflags
 fi
 check_cflags -fno-math-errno
 check_cflags -fno-signed-zeros
